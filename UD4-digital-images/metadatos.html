<!-- Chosen Palette: Warm Stone & Earth - Background: #fafaf9 (Warm Grey 50), Surface: #ffffff (White), Text: #1c1917 (Stone 900), Accents: #ea580c (Orange 600), #059669 (Emerald 600), #4f46e5 (Indigo 600) -->
<!-- Application Structure Plan: The application is designed as a vertical scrolling interactive dashboard titled "La Huella Invisible". It is divided into 5 clear modules matching the didactic session flow. 1. 'El Gancho': An interactive card flipping mechanism to demonstrate the hidden layer of a photo instantly. 2. 'El Laboratorio': A tabbed section to explore Use Cases (Gamer, Influencer, Music) with dynamic text content. 3. 'An√°lisis de Riesgo': A comparative chart section for Platforms. 4. 'Simulaci√≥n GPS': A Plotly scatter plot to visualize geolocation risks. 5. 'Protocolo de Limpieza': A checklist for actionable takeaways. This structure prioritizes "Show, Don't just Tell" to keep adolescents engaged. -->
<!-- Visualization & Content Choices: 1. Radar Chart (Chart.js): To compare EXIF vs IPTC data types. Goal: Compare. Justification: Shows the different 'shapes' of data (Technical vs Legal). 2. Dynamic Tabs (HTML/JS): For Influencer/Gamer scenarios. Goal: Inform/Change. Justification: Keeps interface clean while allowing exploration of specific interests. 3. Bar Chart (Chart.js): Platform Safety Score. Goal: Compare. Justification: Clearly contrasts safe vs unsafe sharing methods using color (Red/Green). 4. Scatter Plot (Plotly Canvas): GPS Simulation. Goal: Relationships. Justification: Visualizes how individual data points cluster to reveal locations (Home/School). 5. Process Flow (CSS Grid): Screenshot Journey. Goal: Change/Flow. Justification: Linear progression of data leakage. -->
<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Huella Invisible: Gu√≠a de Metadatos</title>
    <script src="/assets/tailwind.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Outfit', sans-serif;
            background-color: #fafaf9; /* Stone 50 */
            color: #1c1917; /* Stone 900 */
        }

        /* Chart Container Styling - Mandatory */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }

        /* Card Flip Animation */
        .perspective-1000 {
            perspective: 1000px;
        }
        .transform-style-3d {
            transform-style: preserve-3d;
        }
        .backface-hidden {
            backface-visibility: hidden;
        }
        .rotate-y-180 {
            transform: rotateY(180deg);
        }
        
        .flip-card-inner {
            transition: transform 0.6s;
        }
        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        /* Custom UI Elements */
        .btn-primary {
            background-color: #1c1917;
            color: white;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #ea580c;
            transform: translateY(-2px);
        }
        
        .nav-dot {
            height: 10px;
            width: 10px;
            background-color: #d6d3d1;
            border-radius: 50%;
            display: inline-block;
            transition: all 0.3s;
            cursor: pointer;
        }
        .nav-dot.active {
            background-color: #ea580c;
            transform: scale(1.5);
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation / Progress -->
    <nav class="fixed right-4 top-1/2 transform -translate-y-1/2 z-50 hidden md:flex flex-col gap-4 bg-white/80 p-3 rounded-full shadow-lg backdrop-blur-sm">
        <span class="nav-dot active" onclick="scrollToSection('hero')" title="Inicio"></span>
        <span class="nav-dot" onclick="scrollToSection('concept')" title="Conceptos"></span>
        <span class="nav-dot" onclick="scrollToSection('cases')" title="Casos Reales"></span>
        <span class="nav-dot" onclick="scrollToSection('risks')" title="Riesgos"></span>
        <span class="nav-dot" onclick="scrollToSection('action')" title="Acci√≥n"></span>
    </nav>

    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pb-20">

        <!-- HEADER / HERO SECTION -->
        <header id="hero" class="min-h-screen flex flex-col justify-center items-center py-12">
            <div class="text-center space-y-6 max-w-3xl animate-fade-in-up">
                <span class="inline-block px-4 py-1 rounded-full bg-orange-100 text-orange-700 font-semibold text-sm tracking-wide">SESI√ìN DID√ÅCTICA INTERACTIVA</span>
                <h1 class="text-5xl md:text-7xl font-extrabold text-stone-900 tracking-tight leading-tight">
                    La Huella <span class="text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-red-600">Invisible</span>
                </h1>
                <p class="text-xl text-stone-600 leading-relaxed">
                    ¬øQu√© sabe Internet de ti antes de que publiques? Descubre la informaci√≥n oculta que viaja dentro de cada foto, canci√≥n o captura de pantalla.
                </p>
                
                <!-- Interactive Hook: Flip Card -->
                <div class="mt-12 w-full max-w-md mx-auto h-80 perspective-1000 cursor-pointer flip-card" id="heroCard" onclick="toggleFlip('heroCard')">
                    <div class="flip-card-inner relative w-full h-full transform-style-3d shadow-xl rounded-2xl">
                        <!-- Front: The Image -->
                        <div class="absolute w-full h-full backface-hidden bg-white rounded-2xl overflow-hidden border border-stone-200">
                            <div class="h-48 bg-stone-200 flex items-center justify-center text-6xl">
                                üçî
                            </div>
                            <div class="p-6">
                                <h3 class="font-bold text-lg text-stone-800">Historia de Instagram</h3>
                                <p class="text-stone-500 text-sm">"¬°Hamburguesa en casa! üè† #relax"</p>
                                <div class="mt-4 flex justify-center">
                                    <span class="text-xs font-bold text-orange-600 border border-orange-200 bg-orange-50 px-3 py-1 rounded-full flex items-center gap-2">
                                        üëÜ TOCA PARA VER LA VERDAD
                                    </span>
                                </div>
                            </div>
                        </div>
                        <!-- Back: The Metadata -->
                        <div class="absolute w-full h-full backface-hidden bg-stone-900 text-green-400 p-6 rounded-2xl rotate-y-180 font-mono text-xs md:text-sm overflow-hidden text-left border border-stone-800">
                            <div class="opacity-80">
                                <p>> ANALIZANDO IMAGEN...</p>
                                <p class="mt-2 text-white">DATOS ENCONTRADOS:</p>
                                <p class="mt-2">üì∏ DISPOSITIVO: iPhone 14 Pro</p>
                                <p>‚è±Ô∏è HORA: 14:32:05 (No "Cena")</p>
                                <p>‚ö° FLASH: Off, ISO 200</p>
                                <p class="text-red-400 font-bold mt-2">üìç GPS LAT: 40.416775</p>
                                <p class="text-red-400 font-bold">üìç GPS LON: -3.703790</p>
                                <p class="mt-2">üè† UBICACI√ìN: Calle Principal, 12, Madrid</p>
                                <p class="mt-4 text-white">>> PRIVACIDAD COMPROMETIDA <<</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-12 animate-bounce text-stone-400 text-2xl">‚Üì</div>
        </header>

        <!-- SECTION 1: CONCEPTS (Metadata Types) -->
        <section id="concept" class="py-20 border-t border-stone-200">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold mb-4">El ADN de tus Archivos</h2>
                <p class="text-stone-600 max-w-2xl mx-auto">
                    Los metadatos son "datos sobre los datos". Existen principalmente dos tipos que debes conocer.
                    Aqu√≠ visualizamos qu√© "forma" tiene cada tipo de dato.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <!-- Text Content -->
                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:border-orange-200 transition-colors">
                        <div class="flex items-center gap-4 mb-2">
                            <span class="text-3xl bg-blue-100 p-2 rounded-lg">‚öôÔ∏è</span>
                            <h3 class="text-xl font-bold">EXIF (T√©cnico)</h3>
                        </div>
                        <p class="text-stone-600 text-sm">El registro autom√°tico de la m√°quina. Tu c√°mara escribe esto sin preguntarte.</p>
                        <ul class="mt-3 text-sm text-stone-500 space-y-1 list-disc list-inside">
                            <li>Modelo de c√°mara y lente</li>
                            <li>Configuraci√≥n (ISO, Apertura)</li>
                            <li><strong class="text-orange-600">Coordenadas GPS exactas</strong></li>
                        </ul>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:border-indigo-200 transition-colors">
                        <div class="flex items-center gap-4 mb-2">
                            <span class="text-3xl bg-indigo-100 p-2 rounded-lg">‚öñÔ∏è</span>
                            <h3 class="text-xl font-bold">IPTC / XMP (Identidad)</h3>
                        </div>
                        <p class="text-stone-600 text-sm">Informaci√≥n administrativa a√±adida manualmente o por software de edici√≥n.</p>
                        <ul class="mt-3 text-sm text-stone-500 space-y-1 list-disc list-inside">
                            <li>Nombre del autor/fot√≥grafo</li>
                            <li>Derechos de Copyright</li>
                            <li>Palabras clave y descripciones</li>
                        </ul>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="bg-white p-4 rounded-2xl shadow-lg border border-stone-100">
                    <div class="mb-4 text-center">
                        <h4 class="font-bold text-stone-700">Comparativa de Datos</h4>
                        <p class="text-xs text-stone-400">¬øQu√© guarda cada formato?</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="metadataRadarChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: USE CASES (Interactive Tabs) -->
        <section id="cases" class="py-20 border-t border-stone-200">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold mb-4">Modo Detective: Casos Reales</h2>
                <p class="text-stone-600">
                    Selecciona un perfil para ver c√≥mo los metadatos afectan a diferentes estilos de vida digital.
                </p>
            </div>

            <!-- Tabs -->
            <div class="flex justify-center gap-4 mb-8 flex-wrap">
                <button onclick="setUseCase('influencer')" id="btn-influencer" class="px-6 py-2 rounded-full font-semibold bg-stone-200 text-stone-600 hover:bg-orange-100 hover:text-orange-700 transition-colors">Influencer ü§≥</button>
                <button onclick="setUseCase('gamer')" id="btn-gamer" class="px-6 py-2 rounded-full font-semibold bg-stone-200 text-stone-600 hover:bg-purple-100 hover:text-purple-700 transition-colors">Gamer üéÆ</button>
                <button onclick="setUseCase('music')" id="btn-music" class="px-6 py-2 rounded-full font-semibold bg-stone-200 text-stone-600 hover:bg-green-100 hover:text-green-700 transition-colors">M√∫sica üéµ</button>
            </div>

            <!-- Dynamic Content Area -->
            <div class="bg-white rounded-3xl p-8 shadow-xl border border-stone-100 min-h-[300px] transition-all duration-500" id="case-content">
                <!-- Content injected via JS -->
            </div>
        </section>

        <!-- SECTION 3: PLATFORM RISKS -->
        <section id="risks" class="py-20 border-t border-stone-200">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div class="order-2 md:order-1">
                    <div class="chart-container">
                        <canvas id="platformRiskChart"></canvas>
                    </div>
                </div>
                <div class="order-1 md:order-2 flex flex-col justify-center">
                    <h2 class="text-3xl font-bold mb-6 text-stone-900">¬øD√≥nde est√°n seguros tus datos?</h2>
                    <p class="text-lg text-stone-600 mb-6">
                        No todas las aplicaciones tratan tus fotos igual. Algunas act√∫an como "lavadoras" de datos, borrando todo por seguridad. Otras, las transmiten tal cual.
                    </p>
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h4 class="font-bold text-red-700">‚ö†Ô∏è Riesgo Alto: "Documento"</h4>
                        <p class="text-sm text-red-600 mt-1">
                            Enviar una foto por WhatsApp como <strong>"Documento"</strong> o por Email mantiene el GPS y los datos t√©cnicos intactos. ¬°Cuidado con lo que env√≠as!
                        </p>
                    </div>
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg">
                        <h4 class="font-bold text-green-700">üõ°Ô∏è Zona Segura: Redes Sociales</h4>
                        <p class="text-sm text-green-600 mt-1">
                            Instagram, Twitter y WhatsApp (env√≠o normal) suelen borrar los metadatos al comprimir la imagen.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: GEOLOCATION SIMULATION -->
        <section class="py-20 border-t border-stone-200">
            <div class="text-center max-w-3xl mx-auto mb-12">
                <h2 class="text-3xl font-bold mb-4">El Mapa Oculto</h2>
                <p class="text-stone-600">
                    Si extraemos el GPS de todas tus fotos de un mes, podemos crear un mapa de tu vida. 
                    Este gr√°fico simula 50 fotos analizadas. ¬øVes los patrones?
                </p>
            </div>

            <div class="bg-white p-4 md:p-8 rounded-3xl shadow-lg border border-stone-100">
                <div class="w-full h-[400px]" id="geoPlot"></div>
                <div class="mt-4 flex justify-center gap-6 text-sm">
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-indigo-500"></span>
                        <span class="text-stone-600">Posible Casa (Noches)</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-orange-500"></span>
                        <span class="text-stone-600">Instituto (D√≠a)</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 5: ACTION PLAN -->
        <section id="action" class="py-20 border-t border-stone-200">
            <div class="bg-stone-900 rounded-3xl p-8 md:p-16 text-white text-center shadow-2xl relative overflow-hidden">
                <!-- Decorative background elements -->
                <div class="absolute top-0 left-0 w-64 h-64 bg-orange-500 opacity-10 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"></div>
                <div class="absolute bottom-0 right-0 w-64 h-64 bg-indigo-500 opacity-10 rounded-full blur-3xl translate-x-1/2 translate-y-1/2"></div>

                <h2 class="text-3xl md:text-5xl font-bold mb-8 relative z-10">Operaci√≥n Limpieza üõ°Ô∏è</h2>
                <p class="text-stone-300 max-w-2xl mx-auto mb-12 text-lg relative z-10">
                    Toma el control. Antes de tu pr√≥xima historia, sigue estos pasos para asegurar tu privacidad.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto relative z-10">
                    <div class="bg-stone-800 p-6 rounded-2xl hover:bg-stone-700 transition-colors border border-stone-700">
                        <div class="text-4xl mb-4">‚öôÔ∏è</div>
                        <h3 class="font-bold text-lg mb-2 text-orange-400">Paso 1</h3>
                        <p class="text-stone-300 text-sm">Entra en Ajustes > Privacidad > C√°mara y <strong>desactiva la ubicaci√≥n</strong>.</p>
                    </div>
                    <div class="bg-stone-800 p-6 rounded-2xl hover:bg-stone-700 transition-colors border border-stone-700">
                        <div class="text-4xl mb-4">üßº</div>
                        <h3 class="font-bold text-lg mb-2 text-orange-400">Paso 2</h3>
                        <p class="text-stone-300 text-sm">En Windows: Click Derecho > Propiedades > <strong>"Quitar informaci√≥n personal"</strong>.</p>
                    </div>
                    <div class="bg-stone-800 p-6 rounded-2xl hover:bg-stone-700 transition-colors border border-stone-700">
                        <div class="text-4xl mb-4">üïµÔ∏è</div>
                        <h3 class="font-bold text-lg mb-2 text-orange-400">Paso 3</h3>
                        <p class="text-stone-300 text-sm">Usa herramientas como <strong>Metapicz</strong> para inspeccionar qu√© env√≠as.</p>
                    </div>
                </div>

                <div class="mt-12 p-6 bg-white/10 rounded-xl backdrop-blur-sm inline-block">
                    <p class="font-bold text-lg">üí° Challenge de la Semana</p>
                    <p class="text-stone-300 mt-2">Revisa tu galer√≠a. Si ves el mapa en tus fotos, ¬°internet tambi√©n puede verlo!</p>
                </div>
            </div>
        </section>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- 1. UTILITY FUNCTIONS ---
        // Label wrapping for Chart.js
        function splitLabel(str, maxLen = 16) {
            if (str.length <= maxLen) return str;
            const words = str.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + ' ' + words[i]).length <= maxLen) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
            // Update dots styling
            document.querySelectorAll('.nav-dot').forEach(dot => dot.classList.remove('active'));
            // Ideally find index and add active, simplified here
        }

        // --- 2. HERO INTERACTION ---
        function toggleFlip(id) {
            const card = document.getElementById(id);
            card.classList.toggle('flipped');
        }

        // --- 3. USE CASE TABS LOGIC ---
        const caseContent = document.getElementById('case-content');
        
        const cases = {
            influencer: {
                title: "El Influencer y la 'Espontaneidad'",
                icon: "üì∏",
                color: "bg-orange-50",
                text: "Subes una foto diciendo 'Reci√©n levantado üò¥'. Pero la marca que te quiere contratar analiza los metadatos.",
                data: [
                    { label: "Hora Real", value: "15:30 PM (No ma√±ana)" },
                    { label: "Iluminaci√≥n", value: "Flash de Estudio Detectado" },
                    { label: "Edici√≥n", value: "Adobe Photoshop Lightroom" }
                ],
                implication: "P√©rdida de credibilidad. Los metadatos delatan que la foto fue producida profesionalmente, no espont√°nea."
            },
            gamer: {
                title: "El Gamer y la Victoria √âpica",
                icon: "üéÆ",
                color: "bg-purple-50",
                text: "Haces un screenshot de tu victoria en Fortnite y lo subes a un Discord p√∫blico.",
                data: [
                    { label: "Archivo", value: "Screenshot_2023.png" },
                    { label: "Software", value: "OBS Studio / Windows DVR" },
                    { label: "Monitor", value: "3840x2160 (4K) - ¬°Buen Setup!" },
                    { label: "Riesgo", value: "Usuario de Discord visible en ventana" }
                ],
                implication: "Doxing Accidental. A veces los metadatos del sistema revelan nombres de usuario reales o rutas de carpetas (C:/Users/JuanPerez/Desktop...)."
            },
            music: {
                title: "El Fan de M√∫sica",
                icon: "üéß",
                color: "bg-green-50",
                text: "Descargas un MP3 y lo pasas a tu m√≥vil. ¬øC√≥mo sabe el reproductor el g√©nero?",
                data: [
                    { label: "Tag ID3", value: "v2.3" },
                    { label: "Artista", value: "Bad Bunny" },
                    { label: "BPM", value: "110 (Tempo)" }
                ],
                implication: "Clasificaci√≥n. Las plataformas usan esto para recomendarte m√∫sica. No es peligroso, ¬°es √∫til!"
            }
        };

        function setUseCase(type) {
            const data = cases[type];
            // Update UI buttons
            ['influencer', 'gamer', 'music'].forEach(t => {
                const btn = document.getElementById(`btn-${t}`);
                if (t === type) {
                    btn.classList.add('bg-stone-800', 'text-white');
                    btn.classList.remove('bg-stone-200', 'text-stone-600');
                } else {
                    btn.classList.remove('bg-stone-800', 'text-white');
                    btn.classList.add('bg-stone-200', 'text-stone-600');
                }
            });

            // Update Content with Animation
            caseContent.style.opacity = '0';
            setTimeout(() => {
                caseContent.innerHTML = `
                    <div class="flex flex-col md:flex-row gap-8 items-start">
                        <div class="flex-1">
                            <div class="flex items-center gap-4 mb-4">
                                <span class="text-4xl p-3 rounded-xl ${data.color}">${data.icon}</span>
                                <h3 class="text-2xl font-bold text-stone-800">${data.title}</h3>
                            </div>
                            <p class="text-lg text-stone-600 mb-6">${data.text}</p>
                            <div class="bg-stone-50 p-4 rounded-xl border border-stone-200">
                                <h4 class="font-bold text-stone-700 mb-2">Impacto:</h4>
                                <p class="text-stone-600 text-sm">${data.implication}</p>
                            </div>
                        </div>
                        <div class="w-full md:w-1/3 bg-stone-900 text-green-400 p-6 rounded-xl font-mono text-sm shadow-inner">
                            <p class="border-b border-stone-700 pb-2 mb-2 opacity-50">// DATOS EXTRA√çDOS</p>
                            ${data.data.map(item => `
                                <div class="mb-3">
                                    <span class="block text-stone-500 text-xs">${item.label}:</span>
                                    <span class="block font-bold">${item.value}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                caseContent.style.opacity = '1';
            }, 300);
        }

        // Initialize default tab
        setUseCase('influencer');


        // --- 4. CHARTS CONFIGURATION ---
        
        // Common Chart Defaults
        Chart.defaults.font.family = "'Outfit', sans-serif";
        Chart.defaults.color = '#57534e'; // Stone 600

        // CHART 1: RADAR (Types)
        const ctxRadar = document.getElementById('metadataRadarChart').getContext('2d');
        new Chart(ctxRadar, {
            type: 'radar',
            data: {
                labels: [
                    splitLabel('Geolocalizaci√≥n'),
                    splitLabel('Info C√°mara'),
                    splitLabel('Derechos Autor'),
                    splitLabel('Fecha/Hora'),
                    splitLabel('Descripci√≥n')
                ].map(l => splitLabel(l)),
                datasets: [{
                    label: 'EXIF (Autom√°tico)',
                    data: [100, 100, 10, 100, 10],
                    fill: true,
                    backgroundColor: 'rgba(234, 88, 12, 0.2)', // Orange
                    borderColor: 'rgb(234, 88, 12)',
                    pointBackgroundColor: 'rgb(234, 88, 12)',
                }, {
                    label: 'IPTC (Manual)',
                    data: [0, 10, 100, 50, 100],
                    fill: true,
                    backgroundColor: 'rgba(79, 70, 229, 0.2)', // Indigo
                    borderColor: 'rgb(79, 70, 229)',
                    pointBackgroundColor: 'rgb(79, 70, 229)',
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        angleLines: { color: '#e7e5e4' },
                        grid: { color: '#e7e5e4' },
                        pointLabels: { font: { size: 11 } }
                    }
                },
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: {
                        callbacks: {
                            title: (tooltipItems) => {
                                const item = tooltipItems[0];
                                const label = item.chart.data.labels[item.dataIndex];
                                return Array.isArray(label) ? label.join(' ') : label;
                            }
                        }
                    }
                }
            }
        });

        // CHART 2: BAR (Platforms)
        const ctxBar = document.getElementById('platformRiskChart').getContext('2d');
        new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: ['Email/Adjunto', 'Discord (PC)', 'Flickr', 'WhatsApp', 'Instagram'].map(l => splitLabel(l)),
                datasets: [{
                    label: 'Datos Conservados (%)',
                    data: [100, 100, 85, 5, 2],
                    backgroundColor: [
                        '#ef4444', // Red
                        '#ef4444',
                        '#f97316', // Orange
                        '#22c55e', // Green
                        '#22c55e'
                    ],
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    title: { display: true, text: 'Riesgo de Fuga de Metadatos por Plataforma' },
                    tooltip: {
                        callbacks: {
                            title: (tooltipItems) => {
                                const item = tooltipItems[0];
                                const label = item.chart.data.labels[item.dataIndex];
                                return Array.isArray(label) ? label.join(' ') : label;
                            }
                        }
                    }
                },
                scales: {
                    y: { beginAtZero: true, max: 100, title: { display: true, text: '% de Datos Originales' } },
                    x: { grid: { display: false } }
                }
            }
        });

        // CHART 3: PLOTLY SCATTER (Geolocation)
        // Generate mock clustered data
        function generateCluster(cx, cy, n, spread) {
            let x = [], y = [];
            for (let i = 0; i < n; i++) {
                x.push(cx + (Math.random() - 0.5) * spread);
                y.push(cy + (Math.random() - 0.5) * spread);
            }
            return { x, y };
        }

        const homeCluster = generateCluster(2, 2, 35, 0.8);
        const schoolCluster = generateCluster(5, 5, 20, 1.2);
        const noise = generateCluster(3.5, 3.5, 10, 5);

        const traceHome = {
            x: homeCluster.x,
            y: homeCluster.y,
            mode: 'markers',
            type: 'scatter',
            name: 'Cluster A (Hogar)',
            marker: { color: '#4f46e5', size: 10, opacity: 0.7 }
        };

        const traceSchool = {
            x: schoolCluster.x,
            y: schoolCluster.y,
            mode: 'markers',
            type: 'scatter',
            name: 'Cluster B (Escuela)',
            marker: { color: '#f97316', size: 10, opacity: 0.7 }
        };

        const traceNoise = {
            x: noise.x,
            y: noise.y,
            mode: 'markers',
            type: 'scatter',
            name: 'Dispersos',
            marker: { color: '#a8a29e', size: 6, opacity: 0.4 }
        };

        const layout = {
            margin: { t: 20, r: 20, b: 40, l: 40 },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: '#f5f5f4',
            showlegend: false,
            xaxis: { showgrid: true, gridcolor: '#e7e5e4', zeroline: false, showticklabels: false, title: 'Longitud' },
            yaxis: { showgrid: true, gridcolor: '#e7e5e4', zeroline: false, showticklabels: false, title: 'Latitud' },
            dragmode: 'zoom'
        };

        Plotly.newPlot('geoPlot', [traceHome, traceSchool, traceNoise], layout, { responsive: true, displayModeBar: false });

    </script>
</body>
</html>