<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Maestro: Marble Run de Ingenier√≠a</title>
    <script src="/Digitalizacion-4-ESO/assets/tailwind.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap');

        body {
            font-family: 'Outfit', sans-serif;
            background-color: #f8f9fa;
            color: #1a202c;
        }

        .bg-blueprint {
            background-color: #f1f5f9;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 15px 15px;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: auto;
            height: 300px;
            max-height: 400px;
        }

        .step-card {
            border-left: 4px solid #d97706;
            transition: all 0.3s ease;
        }

        .step-card:hover {
            border-left-width: 8px;
            background-color: #fffbeb;
        }

        .active-nav {
            color: #d97706;
            border-bottom: 3px solid #d97706;
        }

        .progress-bar {
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #d97706;
            width: 0%;
            transition: width 0.5s ease;
        }

        details summary::-webkit-details-marker {
            display: none;
        }
    </style>
    <!-- Chosen Palette: Industrial Craft. Background: Light Gray (#f8f9fa). Primary: Amber (#d97706). Secondary: Slate (#475569). -->
    
    <!-- Application Structure Plan: 
         La estructura se ha redise√±ado para ser una progresi√≥n t√©cnica lineal pero explorable. 
         1. Introducci√≥n y Dashboard de Preparaci√≥n: Control de materiales y l√≥gica de dise√±o.
         2. Masterclass de Construcci√≥n: Un desglose exhaustivo en 6 etapas cr√≠ticas con sub-pasos espec√≠ficos.
         3. Simulador de F√≠sica: Herramienta para validar la teor√≠a antes de la pr√°ctica.
         4. Gu√≠a de Troubleshooting: Resoluci√≥n de problemas complejos.
         
         Se eligi√≥ esta estructura porque la construcci√≥n de una m√°quina de este tipo falla por falta de detalles en las uniones y las pendientes.
    -->

    <!-- Visualization & Content Choices:
         - Proceso de Construcci√≥n -> Lista jer√°rquica con detalles expandibles -> JS para interactividad -> Mayor profundidad visual.
         - Planos de Corte -> Diagramas CSS -> Representaci√≥n visual de medidas de cart√≥n.
         - Din√°mica de Canicas -> Chart.js -> Gr√°fico de velocidad vs. estabilidad.
         - Inventario -> Lista con estado persistente en la sesi√≥n.
         
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
</head>
<body class="flex flex-col min-h-screen">

    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <span class="text-amber-600 text-2xl">üõ†Ô∏è</span>
                <span class="text-xl font-bold text-slate-800 tracking-tight">Marble<span class="text-amber-600">Master</span> v2.0</span>
            </div>
            <div class="hidden md:flex space-x-6 text-sm font-semibold uppercase tracking-wider">
                <button onclick="switchTab('tab-prep')" class="nav-btn active-nav py-5">1. Preparaci√≥n</button>
                <button onclick="switchTab('tab-build')" class="nav-btn py-5">2. Construcci√≥n Detallada</button>
                <button onclick="switchTab('tab-physics')" class="nav-btn py-5">3. Laboratorio</button>
            </div>
            <div class="md:hidden">
                <button onclick="toggleMobileMenu()" class="text-slate-600">Menu</button>
            </div>
        </div>
    </nav>

    <main class="flex-grow max-w-5xl mx-auto w-full p-6">
        
        <!-- SECTION 1: PREPARACI√ìN -->
        <div id="tab-prep" class="tab-content animate-fade-in">
            <header class="mb-10 text-center">
                <h1 class="text-4xl font-bold text-slate-900 mb-2">Fundamentos y Materiales</h1>
                <p class="text-slate-600">La calidad de tu m√°quina depende de la rigidez de tus bases.</p>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <span class="mr-2">üìã</span> Lista de Despiece
                    </h3>
                    <div class="space-y-3" id="mat-checklist">
                        <!-- JS Loaded -->
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4">üìê Dimensiones Cr√≠ticas</h3>
                    <ul class="text-sm space-y-4">
                        <li class="flex justify-between border-b pb-2">
                            <span class="text-slate-500">Base Principal</span>
                            <span class="font-mono font-bold">600 x 450 mm</span>
                        </li>
                        <li class="flex justify-between border-b pb-2">
                            <span class="text-slate-500">Ancho de Pista (Interior)</span>
                            <span class="font-mono font-bold">22 mm</span>
                        </li>
                        <li class="flex justify-between border-b pb-2">
                            <span class="text-slate-500">Altura de Torres</span>
                            <span class="font-mono font-bold">550 mm</span>
                        </li>
                        <li class="flex justify-between border-b pb-2">
                            <span class="text-slate-500">Di√°metro Polea Motor</span>
                            <span class="font-mono font-bold">90 mm</span>
                        </li>
                    </ul>
                    <div class="mt-6 p-4 bg-blueprint rounded-lg border border-slate-300 text-xs text-slate-600 italic">
                        *Nota: El cart√≥n corrugado tiene un sentido de fibra. Corta las rampas a favor de la fibra para que no se doblen con el tiempo.
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 2: CONSTRUCCI√ìN DETALLADA -->
        <div id="tab-build" class="tab-content hidden animate-fade-in">
            <header class="mb-8">
                <h2 class="text-3xl font-bold text-slate-900">Gu√≠a de Montaje Paso a Paso</h2>
                <div class="flex items-center mt-2">
                    <div class="progress-bar flex-grow">
                        <div id="build-progress" class="progress-fill"></div>
                    </div>
                    <span id="progress-text" class="ml-4 text-sm font-bold text-amber-600">0%</span>
                </div>
            </header>

            <div class="space-y-6" id="detailed-steps">
                <!-- Injected via JS -->
            </div>
        </div>

        <!-- SECTION 3: LABORATORIO DE F√çSICA -->
        <div id="tab-physics" class="tab-content hidden animate-fade-in">
            <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                <h2 class="text-2xl font-bold mb-6">Analizador de Pendientes y Fricci√≥n</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                    <div>
                        <p class="text-slate-600 mb-6 text-sm">
                            Utiliza este gr√°fico para entender la relaci√≥n entre el √°ngulo de la rampa y la p√©rdida de control. 
                            El objetivo es mantener la canica en la zona de "Flujo Laminar".
                        </p>
                        <div class="chart-container">
                            <canvas id="physicsChart"></canvas>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-slate-50 p-6 rounded-xl border border-slate-200">
                            <label class="block text-sm font-bold text-slate-700 mb-4">Ajustar Inclinaci√≥n de Prueba</label>
                            <input type="range" id="physicsSlider" min="0" max="30" value="8" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-amber-600">
                            <div class="flex justify-between mt-2 font-mono text-lg text-amber-600">
                                <span id="currentAngle">8¬∞</span>
                                <span id="angleStatus" class="text-sm font-sans uppercase">√ìptimo</span>
                            </div>
                        </div>
                        <div id="physics-feedback" class="p-4 rounded-lg text-sm leading-relaxed">
                            <!-- JS Dynamic content -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-slate-900 text-white p-8 mt-12">
        <div class="max-w-5xl mx-auto flex flex-col md:flex-row justify-between items-center text-sm">
            <p>&copy; 2024 Proyecto MarbleMaster - Ingenier√≠a en Cart√≥n</p>
            <div class="flex space-x-4 mt-4 md:mt-0">
                <span>Versi√≥n: 2.5.1</span>
                <span>‚Ä¢</span>
                <span>Documentaci√≥n de C√≥digo Abierto</span>
            </div>
        </div>
    </footer>

    <script>
        // --- DATA DE MATERIALES ---
        const materials = [
            { id: 1, name: "Base de cart√≥n doble (60x45cm)", completed: false },
            { id: 2, name: "4 Columnas de soporte (55cm)", completed: false },
            { id: 3, name: "Motorreductor 6V + Portapilas", completed: false },
            { id: 4, name: "Cinta de cart√≥n/tela para elevador", completed: false },
            { id: 5, name: "10 Canicas de vidrio (16mm)", completed: false },
            { id: 6, name: "Pistola de silicona + 20 barras", completed: false }
        ];

        // --- DATA DE CONSTRUCCI√ìN (M√ÅS EXTENSA) ---
        const steps = [
            {
                title: "Fase 1: La Cimentaci√≥n y Torres de Carga",
                desc: "Antes de cualquier rampa, necesitamos un chasis s√≥lido. Sin rigidez, las rampas se desalinear√°n.",
                substeps: [
                    "<strong>Refuerzo de Base:</strong> Pega dos planchas de 60x45cm cruzando la direcci√≥n de la fibra para evitar que se curve con el peso.",
                    "<strong>Anclaje de Torres:</strong> Corta 4 perfiles en 'L' de cart√≥n de 50cm. P√©galos en las esquinas interiores de la base usando escuadras de cart√≥n para asegurar un √°ngulo de 90¬∞ exacto.",
                    "<strong>Marcado de Niveles:</strong> Usa un nivel de burbuja o regla para marcar l√≠neas cada 5cm en las torres. Esto facilitar√° el pegado de rampas m√°s tarde."
                ],
                tip: "Usa cinta de carrocero para sujetar las torres mientras la silicona se enfr√≠a totalmente."
            },
            {
                title: "Fase 2: El Sistema de Elevaci√≥n Continua",
                desc: "El coraz√≥n de la m√°quina. Un elevador tipo 'cangilones' que devuelve las canicas a la cima.",
                substeps: [
                    "<strong>Fabricaci√≥n de Poleas:</strong> Corta 6 discos de 8cm de di√°metro. Pega 3 para cada polea (superior e inferior) para crear un canal central que gu√≠e la cinta.",
                    "<strong>Instalaci√≥n del Motor:</strong> Monta el motor en la parte inferior. El eje debe atravesar la polea inferior. Asegura el motor con una abrazadera de cart√≥n y tornillos peque√±os.",
                    "<strong>La Cinta Transportadora:</strong> Usa una tira de cartulina r√≠gida de 3cm de ancho. Pega peque√±os 'asientos' (trozos de tubo o cajas de 2x2cm) cada 10cm.",
                    "<strong>Tensi√≥n:</strong> La polea superior debe ser m√≥vil (ranura de ajuste) para poder tensar la cinta y evitar que patine."
                ],
                tip: "A√±ade una goma el√°stica alrededor de las poleas para aumentar la fricci√≥n con la cinta."
            },
            {
                title: "Fase 3: Ingenier√≠a de Rampas y Curvas",
                desc: "Donde la gravedad se convierte en movimiento. La geometr√≠a aqu√≠ es cr√≠tica.",
                substeps: [
                    "<strong>Pistas Rectas:</strong> Tiras de 4cm de ancho. Dobla 1cm a cada lado (usa un c√∫ter sin presionar para marcar el doblez). El canal central debe ser de 22mm exactos.",
                    "<strong>Curvas de Retorno:</strong> Corta formas de 'C' en cart√≥n. Pega una tira flexible de cartulina fina en el borde exterior para crear una pared curva de 2cm de alto.",
                    "<strong>C√°lculo de Inclinaci√≥n:</strong> Por cada 20cm de largo, la rampa debe bajar 2cm (Pendiente del 10%)."
                ],
                tip: "Lija los bordes donde se unen las rampas. Un escal√≥n de 1mm puede detener una canica."
            },
            {
                title: "Fase 4: El M√≥dulo de Descenso Complejo",
                desc: "A√±adiremos elementos visuales y auditivos al recorrido.",
                substeps: [
                    "<strong>El Embudo:</strong> Crea un cono de cart√≥n con un agujero de 30mm en el centro. Las canicas girar√°n en espiral antes de caer.",
                    "<strong>El Xil√≥fono de Cart√≥n:</strong> Corta peque√±as tiras de madera o cart√≥n extra duro y col√≥calas como escalones para que la canica haga ruido al bajar.",
                    "<strong>El Zig-Zag:</strong> Monta 4 rampas cortas (10cm) en √°ngulos opuestos con una ca√≠da pronunciada para crear un movimiento err√°tico."
                ],
                tip: "Asegura que el embudo est√© perfectamente nivelado para que la espiral sea sim√©trica."
            },
            {
                title: "Fase 5: Circuito de Retorno y Alimentaci√≥n",
                desc: "El cierre del bucle. La canica debe volver sola al elevador.",
                substeps: [
                    "<strong>Trampa de Captura:</strong> Crea una caja ancha al final del recorrido que canalice todas las canicas hacia la base del elevador.",
                    "<strong>Alineaci√≥n de Carga:</strong> La rampa final debe entregar la canica justo en el momento en que un 'cangil√≥n' del elevador pasa por debajo.",
                    "<strong>Protecciones laterales:</strong> A√±ade paredes extra altas en la zona de recepci√≥n para evitar rebotes fuera de la m√°quina."
                ],
                tip: "Prueba esta secci√≥n dejando caer 5 canicas a la vez para ver si hay atascos en el cuello de botella."
            },
            {
                title: "Fase 6: Calibraci√≥n y Troubleshooting",
                desc: "Ajuste fino de la velocidad y fiabilidad.",
                substeps: [
                    "<strong>Prueba de Resistencia:</strong> Deja la m√°quina funcionando 15 minutos seguidos. Observa d√≥nde se producen los fallos.",
                    "<strong>Regulaci√≥n de Voltaje:</strong> Si el motor va muy r√°pido, las canicas saltar√°n. Usa pilas medio gastadas o un potenci√≥metro para reducir la velocidad.",
                    "<strong>Sellado Final:</strong> Una vez todo funcione, refuerza todas las uniones con una segunda capa de silicona fr√≠a o cola blanca."
                ],
                tip: "Usa grafito de un l√°piz en los ejes de las poleas para que giren con menos fricci√≥n."
            }
        ];

        // --- L√ìGICA DE NAVEGACI√ìN ---
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-nav'));
            event.currentTarget.classList.add('active-nav');
        }

        // --- L√ìGICA DE INVENTARIO ---
        function renderMaterials() {
            const container = document.getElementById('mat-checklist');
            container.innerHTML = '';
            materials.forEach(m => {
                const div = document.createElement('div');
                div.className = "flex items-center p-2 hover:bg-slate-50 rounded transition-colors cursor-pointer";
                div.onclick = () => {
                    m.completed = !m.completed;
                    renderMaterials();
                };
                div.innerHTML = `
                    <div class="w-6 h-6 border-2 rounded mr-3 flex items-center justify-center ${m.completed ? 'bg-amber-500 border-amber-500' : 'border-slate-300'}">
                        ${m.completed ? '<span class="text-white text-xs">‚úì</span>' : ''}
                    </div>
                    <span class="text-sm ${m.completed ? 'line-through text-slate-400' : 'text-slate-700'}">${m.name}</span>
                `;
                container.appendChild(div);
            });
        }

        // --- L√ìGICA DE PASOS DETALLADOS ---
        let completedSteps = new Set();
        function renderSteps() {
            const container = document.getElementById('detailed-steps');
            container.innerHTML = '';
            steps.forEach((s, i) => {
                const div = document.createElement('div');
                div.className = "bg-white p-6 rounded-xl shadow-sm border border-slate-200 step-card";
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold text-slate-800">${s.title}</h3>
                        <input type="checkbox" onchange="toggleStepProgress(${i})" class="w-5 h-5 accent-amber-600">
                    </div>
                    <p class="text-slate-600 mb-4 text-sm font-medium">${s.desc}</p>
                    <ul class="space-y-3 mb-6">
                        ${s.substeps.map(ss => `<li class="text-sm text-slate-700 flex items-start"><span class="text-amber-500 mr-2">‚Ä¢</span> <div>${ss}</div></li>`).join('')}
                    </ul>
                    <div class="bg-blue-50 p-3 rounded border border-blue-100 text-xs text-blue-800">
                        <strong>üí° Consejo Pro:</strong> ${s.tip}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function toggleStepProgress(index) {
            if(completedSteps.has(index)) completedSteps.delete(index);
            else completedSteps.add(index);
            
            const progress = (completedSteps.size / steps.length) * 100;
            document.getElementById('build-progress').style.width = progress + '%';
            document.getElementById('progress-text').innerText = Math.round(progress) + '%';
        }

        // --- L√ìGICA DE F√çSICA (CHART.JS) ---
        let chart;
        function initPhysics() {
            const ctx = document.getElementById('physicsChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [0, 5, 10, 15, 20, 25, 30],
                    datasets: [{
                        label: 'Estabilidad del Recorrido (%)',
                        data: [0, 80, 100, 85, 60, 30, 5],
                        borderColor: '#d97706',
                        backgroundColor: 'rgba(217, 119, 6, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, max: 100 },
                        x: { title: { display: true, text: '√Ångulo de Inclinaci√≥n (¬∞)' } }
                    }
                }
            });

            const slider = document.getElementById('physicsSlider');
            slider.oninput = function() {
                const val = this.value;
                document.getElementById('currentAngle').innerText = val + '¬∞';
                updatePhysicsFeedback(val);
            };
            updatePhysicsFeedback(8);
        }

        function updatePhysicsFeedback(angle) {
            const fb = document.getElementById('physics-feedback');
            const status = document.getElementById('angleStatus');
            
            if(angle < 5) {
                status.innerText = "Insuficiente";
                status.className = "text-sm font-sans uppercase text-red-500";
                fb.className = "p-4 rounded-lg bg-red-50 text-red-800 border border-red-200 text-sm";
                fb.innerHTML = "<strong>Fallo:</strong> La canica se detendr√° debido a la fricci√≥n superficial del cart√≥n. Necesitas al menos 5 grados.";
            } else if(angle <= 12) {
                status.innerText = "√ìptimo";
                status.className = "text-sm font-sans uppercase text-green-600 font-bold";
                fb.className = "p-4 rounded-lg bg-green-50 text-green-800 border border-green-200 text-sm";
                fb.innerHTML = "<strong>√âxito:</strong> Flujo perfecto. La energ√≠a cin√©tica compensa la fricci√≥n sin perder contacto con la pista.";
            } else {
                status.innerText = "Cr√≠tico";
                status.className = "text-sm font-sans uppercase text-amber-600";
                fb.className = "p-4 rounded-lg bg-amber-50 text-amber-800 border border-amber-200 text-sm";
                fb.innerHTML = "<strong>Advertencia:</strong> Demasiada velocidad. La canica rebotar√° en las paredes y probablemente saltar√° fuera en la pr√≥xima curva.";
            }
        }

        // --- INICIO ---
        window.onload = () => {
            renderMaterials();
            renderSteps();
            initPhysics();
        };
    </script>
</body>
</html>